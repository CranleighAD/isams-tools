#!/usr/bin/env python3
# run this file from crontab, to run weekdays at 8am:
# 0 8 * * 1-5 /usr/bin/python3 /path/to/isams-tools/bin/isams_tools register_reminder 1 >/dev/null 2>&1 

import sys
import os

sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
# noinspection PyPep8
from isams_tools import dispatch  # this must stay after the above line to work in CLI

import argparse
p = argparse.ArgumentParser(description='...')
p.add_argument('module', help='Name of the module to run')
p.add_argument('--args', required=False, nargs=1, metavar=('arg'), help='Optional arguments for the module')


args = p.parse_args()

if args.module == "register_reminder":
    if args.args and int(args.args[0]) in range(1, 4):
        dispatch('register_reminder', stage=int(args.args[0]))
    else:
        exit("register_reminder needs an argument of 1-3 for the stage, e.g. isams_tools register_reminder --args 1")
else:
    exit("Incorrect module given")
